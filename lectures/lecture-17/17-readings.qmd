---
title: QTM 385 - Experimental Methods
subtitle: Lecture 17 - Interference 
author:
  - name: Danilo Freire
    email: danilo.freire@emory.edu
    affiliations: Emory University
format:
  clean-revealjs:
    self-contained: true
    code-overflow: wrap
    footer: "[Discussion](https://raw.githack.com/danilofreire/qtm385/main/lectures/lecture-17/17-discussion.html)"
transition: slide
transition-speed: default
scrollable: true
engine: knitr
revealjs-plugins:
  - multimodal
editor:
  render-on-save: true
---

# How are you doing? ðŸ˜Š {background-color="#2d4563"}

# Brief recap ðŸ“š {background-color="#2d4563"}

## Brief recap ðŸ“š

:::{style="margin-top: 20px; font-size: 22px;"}
:::{.columns}
:::{.column width="50%"}
- [Spillovers]{.alert} are a common problem in social science research
- They can be [positive or negative]{.alert}, and they can be [modelled explicitly]{.alert} in our analysis
- There are several methods to deal with spillovers, such as [multi-level designs]{.alert}, [within-subject designs]{.alert}, [repeated-measures experiments]{.alert}, and [waitlist designs]{.alert}
- Each design has its [advantages and disadvantages]{.alert}, and the choice of design should be based on the [research question]{.alert} and the [context]{.alert}
- You can use [DeclareDesign](https://declaredesign.org/r/designlibrary/) to simulate spillover designs and pretest posttest designs
- The statistical analysis of waitlist designs are a little tricky, but you can use the [swCRTdesign](https://cran.r-project.org/web/packages/swCRTdesign/index.html) package in R to help you with that
:::

::: {.column width="50%"}
:::{style="text-align: center;"}
![](figures/forbes.webp){width=100%}

Source: [Forbes (2022)](https://www.forbes.com/councils/forbesbusinesscouncil/2022/10/14/network-effects-how-your-connections-matter/)
:::
:::
:::
:::

# Today's plan ðŸ“… {background-color="#2d4563"}

## Interference and spillovers

:::{style="font-size: 29px; margin-top: 30px;"}
:::{.columns}
:::{.column width="50%"}
- Three readings for today:
  - [Centola (2010)](https://www.science.org/doi/abs/10.1126/science.1185231): "The Spread of Behavior in an Online Social Network Experiment"
  - [Paluk et al (2021)](https://www.pnas.org/doi/abs/10.1073/pnas.1514483113): "Changing climates of conflict: A social network experiment in 56 schools"
  - [Gerber and Green (2000)](https://doi.org/10.2307/2585837): "The Effects of Canvassing, Telephone Calls, and Direct Mail on Voter Turnout: A Field Experiment"
:::

:::{.column width="50%"}
:::{style="text-align: center;"}
![](figures/centola.png){width=100%}

Source: [Centola (2010)](https://www.science.org/doi/abs/10.1126/science.1185231) 
:::
:::
:::
:::

# Interference {background-color="#2d4563"}

# Waitlist designs {background-color="#2d4563"}

## Waitlist designs

:::{style="margin-top: 30px; font-size: 27px;"}
- The final type of design we will discuss today is the [waitlist design]{.alert}, also known as the [stepped-wedge design]{.alert}
- Their scientific value comes from their [ability to track treatment effects among several subjects as they play out over time]{.alert}
- Waitlists play a diplomatic role because they [overcome the problem of withholding treatment from a control group]{.alert} (remember our ethics discussion?)
- In this design, every subject is treated eventually; [random assignment determines when they receive treatment]{.alert}
- It is a [hybrid between a within-subject and a between-subject design]{.alert}, and it is [widely used in public health interventions]{.alert} (e.g., vaccine rollouts)
:::

## Waitlist designs

:::{style="margin-top: 20px; font-size: 23px; text-align: center;"}
![](figures/sw.png){width=80%}

Source: [Hemming et al (2014)](https://doi.org/10.1136/bmj.h391)
:::

## Example: TV advertising and candidate support

:::{style="margin-top: 20px; font-size: 23px;"}
:::{.columns}
:::{.column width="50%"}
- Imagine you are a political consultant and you want to test the [effect of TV advertising on candidate support]{.alert}
- Ads are aired during [three weeks]{.alert}, and outcomes (support for the gubernatorial candidate as gauged by opinion polls) are [assessed at the end of each week]{.alert}
- Eight media markets are randomly assigned to [one of four conditions]{.alert}:
  - [Two media markets]{.alert} are randomly assigned to air ads for three weeks starting in [week 1]{.alert}
  - [Two markets]{.alert} air ads for two weeks starting in [week 2]{.alert}
  - [Two markets]{.alert} air ads for one week starting in [week 3]{.alert}
  - And [two markets air no ads at all]{.alert}
:::

:::{.column width="50%"}
- There are just [three relevant potential outcomes]{.alert}: 
  - $Y_{00}$: untreated during preceding and current periods
  - $Y_{01}$: untreated during the preceding period but treated during the current period
  - $Y_{11}$: treated in both the preceding and current periods
  - Given the design, we never observe the potential outcome $Y_{10}$ because media markets never cease to run ads once they start
:::
:::
:::

## Advertising waitlist experimentâ€™s random assignments and observed outcomes

:::{style="margin-top: 20px; font-size: 26px; text-align: center;"}
:::{.columns}
:::{.column width="33%"}
**Assigned treatment**

| Market | Week 1 | Week 2 | Week 3 |
|---|---|---|---|
| 1 | 01 | 11 | 11 |
| 2 | 00 | 00 | 01 |
| 3 | 00 | 01 | 11 |
| 4 | 00 | 00 | 01 |
| 5 | 00 | 00 | 00 |
| 6 | 01 | 11 | 11 |
| 7 | 00 | 00 | 00 |
| 8 | 00 | 01 | 11 |
:::

:::{.column width="34%"}
**Observed outcomes**

| Market | Week 1 | Week 2 | Week 3 |
|---|---|---|---|
| 1 | 7 | 9 | 4 |
| 2 | 7 | 5 | 7 |
| 3 | 1 | 2 | 10 |
| 4 | 4 | 3 | 10 |
| 5 | 3 | 3 | 3 |
| 6 | 10 | 8 | 10 |
| 7 | 2 | 3 | 4 |
| 8 | 3 | 1 | 3 |
:::

:::{.column width="33%"}
**Probabilities of assignment to treatment condition**

| Treatment Condition | Week 1 | Week 2 | Week 3 |
|---|---|---|---|
| Pr(00) | 0.75 | 0.50 | 0.25 |
| Pr(01) | 0.25 | 0.25 | 0.25 |
| Pr(11) | 0 | 0.25 | 0.50 |
:::
:::
:::

## Estimating the immediate effect of TV advertising

:::{style="margin-top: 20px; font-size: 26px;"}
- The immediate treatment effect is $Y_{01} - Y_{00}$, that is, the effect of being treated in the current period but not in the preceding period
- We just need to take the numbers from the tables and apply inverse probability weighting again

$$
\begin{aligned}
\widehat{E}[Y_{01} - Y_{00}] &= \frac{\frac{7 + 10}{0.25} + \frac{2 + 1}{0.25} + \frac{7 + 10}{0.25}}{\frac{2}{0.25} + \frac{2}{0.25} + \frac{2}{0.25}} \\
&- \frac{\frac{7 + 1 + 4 + 4 + 3 + 2 + 3}{0.75} + \frac{5 + 3 + 3 + 3}{0.50} + \frac{3 + 4}{0.25}}{\frac{6}{0.75} + \frac{4}{0.50} + \frac{2}{0.25}} = 2.72.
\end{aligned}
$$
:::

## Estimating the cumulative effect of TV advertising

:::{style="margin-top: 20px; font-size: 26px;"}
- Finally, we will estimate the cumulative effect of TV advertising, which is $Y_{11} - Y_{00}$, that is, the effect of being treated in both the preceding and current periods
- We do the same thing again, but now we consider the $Y_{11}$ potential outcomes
- However, we must restrict our attention to the second and third weeks, because this type of treatment cannot occur
in the first week

$$
\begin{aligned}
\widehat{E}[Y_{11} - Y_{00}] &= \frac{\frac{9 + 8}{0.25} + \frac{4 + 10 + 10 + 3}{0.50}}{\frac{2}{0.25} + \frac{4}{0.50}} \\
&- \frac{\frac{5 + 3 + 3 + 3}{0.50} + \frac{3 + 4}{0.25}}{\frac{4}{0.50} + \frac{2}{0.25}} = 4.13.
\end{aligned}
$$
:::

## Conclusion

:::{style="margin-top: 20px; font-size: 28px;"}
- [Spillovers]{.alert} are a common problem in social science research
- They can be [positive or negative]{.alert}, and they can be [modelled explicitly]{.alert} in our analysis
- There are several methods to deal with spillovers, such as [multi-level designs]{.alert}, [within-subject designs]{.alert}, [repeated-measures experiments]{.alert}, and [waitlist designs]{.alert}
- Each design has its [advantages and disadvantages]{.alert}, and the choice of design should be based on the [research question]{.alert} and the [context]{.alert}
- You can use [DeclareDesign](https://declaredesign.org/r/designlibrary/) to simulate spillover designs and pretest posttest designs
- The statistical analysis of waitlist designs are a little tricky, but you can use the [swCRTdesign](https://cran.r-project.org/web/packages/swCRTdesign/index.html) package in R to help you with that
:::

# And that's all for today! ðŸŽ‰ {background-color="#2d4563"}

# See you next time! ðŸ˜‰ {background-color="#2d4563"}